---
title: "React Hooks와 Context를 이용한 설계 패턴"
description: "데이터 계층과 뷰 계층을 효과적으로 분리하기 위한 방법을 고민해보았습니다."
date: 2019-08-05T22:43:43+09:00
draft: false
authors: "Husky"
author_github: "https://github.com/huskyhoochu/"
images: ["/favicon_package/android-chrome-512x512.png"]
tags: ["react"]
---

#### 기존 컴포넌트 설계 방식의 문제점

예제: 커스텀 폼을 정의한 뒤 여러 컴포넌트에서 받아다 쓸 때. 이것도 클래스형 컴포넌트 시절보다는 나아진 형태이지만 여전히 문제가 있다.

#### Hooks만 쓰는 경우: 컴포넌트 간 상태 공유가 어려움

커스텀 훅 정의해서 컴포넌트에 직접 가져다 쓰면, 그 주변의 여러 컴포넌트가 상태를 받아다 써야 되는데 여기서 문제가 생긴다. 훅에서 정의된 상태는 스스로를 전파할 수 없고 반드시 자식 컴포넌트에게 props 형태로 물려주어야 한다. 자식에서 부모로 전달하는 건 불가능함. 그러다 보니 그 지역의 가장 부모인 컴포넌트가 모든 메서드와 상태를 전부 짊어지고 자식들한테 일일이 던져줘야 하는 문제 발생.

#### Context만 쓰는 경우: 지역적으로만 사용 가능

컨텍스트는 provider 이하 모든 컴포넌트가 컨텍스트 값을 공유할 수 있다. 이것은 장점이지만 컨텍스트에서 정의된 메서드는 재사용될 수 없으며 그 컨텍스트에서 정의한 형태로 유일하게 남겨진다. 이걸 극복하자고 프로젝트 전체를 감싸게 되면... 그럴거면 리덕스를 쓰지!

#### Hooks + Context => 메서드 재사용 + 상태 공유

재사용하려는 메서드는 hooks로 정의하고, 이 hook을 컨텍스트가 사용하게 함으로써 재사용과 상태 공유의 이점을 둘다 가져가는 것이 포인트.

다시 예제로 돌아오면, 커스텀 훅으로 정의된 폼 관련 상태와 메서드는 프로젝트의 어떤 지역에서도 재사용 가능함. 근데 이걸 컴포넌트가 직접 호출하는 게 아니라 지역 컴포넌트를 감싸고 있는 컨텍스트가 호출함. 그러면 컨텍스트는 커스텀 훅에 정의된 메서드와 상태를 프로바이더로 공급함. 이제 내부의 모든 컴포넌트는 자유롭게 그것들을 가져다 쓸 수 있음. 부모가 자식에게 일일이 물려 줄 필요 없음. 그러면서도 이 상태 공유는 정확하게 컨텍스트가 감싸는 범위 안에서만 이뤄짐. 캡슐화 가능. 프로젝트의 다른 영역에서 새로운 컨텍스트를 정의하고, 아까 썼던 커스텀 훅을 또 불러와도 상관이 없다.

